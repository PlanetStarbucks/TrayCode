const input = {
	subKeyValue: [],
	keySizeLimit: 350000,
	data: {
		key: {
			subKeys: [
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-1",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-2",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-3",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-4",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-5",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-6",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-7",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-8",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-9",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-10",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-11",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-12",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-13",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-14",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-15",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-16",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-17",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-18",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-19",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-20",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-21",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-22",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-23",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-24",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-25",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-26",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-27",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-28",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-29",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-30",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-31",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-32",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-33",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-34",
				"16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-35",
			],
			name: "16417aa6-0334-4804-9419-7f8f141cc4ce",
			items: 3534,
			key: "adobeStockSyncListTest",
			activeSubKey: "16417aa6-0334-4804-9419-7f8f141cc4ce-adobeStockSyncListTest-35",
		},
		writeData: {
			id: "187893402",
			title: "Diseño de guía de estilo básica",
			creator_name: "The Routine Creative",
			creator_id: "207013623",
			country_name: "United States of America",
			width: "2048",
			height: "1424",
			thumbnail_url: "https://as1.ftcdn.net/v2/jpg/01/87/89/34/500_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_html_tag: '<img src="https://as1.ftcdn.net/v2/jpg/01/87/89/34/500_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg" alt="Diseño de guía de estilo básica" title="Template: Diseño de guía de estilo básica" zoom_ratio="1.1313708499" zoom_depth_max="2" />',
			thumbnail_width: "500",
			thumbnail_height: "348",
			thumbnail_110_url: "https://as1.ftcdn.net/jpg/01/87/89/34/110_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_110_width: "110",
			thumbnail_110_height: "76",
			thumbnail_160_url: "https://as1.ftcdn.net/jpg/01/87/89/34/160_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_160_width: "160",
			thumbnail_160_height: "111",
			thumbnail_220_url: "https://as1.ftcdn.net/jpg/01/87/89/34/220_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_220_width: "220",
			thumbnail_220_height: "153",
			thumbnail_240_url: "https://t3.ftcdn.net/jpg/01/87/89/34/240_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_240_width: "345.32374100719426",
			thumbnail_240_height: "240",
			thumbnail_500_url: "https://as1.ftcdn.net/v2/jpg/01/87/89/34/500_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_500_width: "500",
			thumbnail_500_height: "348",
			thumbnail_1000_url: "https://as1.ftcdn.net/v2/jpg/01/87/89/34/1000_F_187893402_YZ2XMGeokKcfvIi7AunND0TBPTyFmoKA.jpg",
			thumbnail_1000_width: "1000",
			thumbnail_1000_height: "695",
			media_type_id: "7",
			category: "",
			keywords: [
				{
					name: ["printing", "pamphlet", "design", "personalize", "size", "showing", "role model", "margin", "edge", "mark", "trimming", "trimmed", "coloration", "template", "template"],
				},
			],
			has_releases: "0",
			comp_width: "1000",
			comp_height: "695",
			is_licensed: "Standard",
			vector_type: "",
			content_type: "application/vnd.adobe.indesign.template",
			framerate: "",
			duration: "",
			details_url: "https://stock.adobe.com/187893402?as_channel=affiliate&as_source=api&as_content=eff2ff028e324868b0f32e773e3966cc",
			template_type_id: "3",
			template_category_ids: ["3"],
			marketing_text: "",
			description: "##### Diseño brillante y llamativo para la guía de estilo o el manual de marca de su empresa.\r\n* Diseños horizontales para formatos A4 y carta US\r\n* 14 páginas\r\n* Estilos de objetos, párrafos y caracteres fácilmente personalizables\r\n\r\n\r\n\r\n",
			size_bytes: "2260992",
			premium_level_id: "1",
			is_premium: "false",
			is_loop: "false",
			is_transparent: "false",
			video_preview_url: "",
			video_preview_width: "",
			video_preview_height: "",
			video_preview_content_length: "",
			video_preview_content_type: "",
			video_small_preview_url: "",
			video_small_preview_width: "",
			video_small_preview_height: "",
			video_small_preview_content_length: "",
			video_small_preview_content_type: "",
			is_gentech: "false",
			license: "Standard",
			license_date: "11/16/18, 12:59 PM",
			download_url: "https://stock.adobe.com/Rest/Libraries/Download/187893402/1",
			content_url: "https://stock.adobe.com/Rest/templates/diseno-de-guia-de-estilo-basica/187893402",
		},
	},
};

const run = function (input) {
	//increment the items by 1
	input.data.key.items++;

	//set initial state of returnData object
	let returnData = {
		createNewKey: false,
		currentLength: JSON.stringify(input.subKeyValue).length,
		dataLength: JSON.stringify(input.data.writeData).length,
		dataLimit: JSON.stringify(input.data.writeData).length >= input.keySizeLimit,
		totalKeysLimit: false,
		nextKey: `${input.data.key.name}-${input.data.key.key}-${Number(input.data.key.activeSubKey.split("-").pop()) + 1}`,
		metaKey: input.data,
	};

	//check if the expected size will be bigger than the limit, if so, set createNewKey to true for the WF to create a new key
	if (returnData.currentLength + returnData.dataLength >= input.keySizeLimit) {
		returnData.createNewKey = true;
		returnData.totalKeysLimit = input.data.key.subKeys.length >= 15;
		returnData.newDataLength = returnData.currentLength + returnData.dataLength;
	} else {
		returnData.newDataLength = returnData.currentLength + returnData.dataLength;
	}
	return returnData;
};

console.log(run(input));
